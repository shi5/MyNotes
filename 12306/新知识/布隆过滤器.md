---
date created: 2023-10-25 16:16
---

## 布隆过滤器

- 用途：检验一个元素是否存在集合中，可用于解决Redis缓存穿透问题

### 结构组成

- 组成：很长的二进制向量 +  一系列随机映射函数
	- redis中：一个大型位数组（二进制数组）+ 多个无偏hash函数。
		- 无偏的hash函数是指把元素的hash值计算的**比较均匀**的hash函数。
	- 参数： 预计加入元素的大小n，运行的错误率f。
		- 根据上述参数算出进制数组的大小l，以及无偏hash函数的个数k。
			- 错误率越低，位数组越长，空间占用较大
			- 错误率越低，无偏hash函数越多，计算耗时较长

### 增删查改

- 增加元素：
	- 操作过程：
		1. 通过k个无偏hash函数计算得到k个hash值
		2. 依次取模数组长度，得到数组索引
		3. 将计算得到的数组索引下标位置数据修改为1

- 查询元素：
	- 操作过程：
		1. 通过k个无偏hash函数计算得到k个hash值
		2. 依次取模数组长度，得到数组索引
		3. 判断索引处的值是否全部为1，如果全部为1则存在（这种存在可能是误判），如果存在一个0则必定不存在
	- 存在问题：可能发生误判，如两个key的hash完全一样，key1存进去了，会认为key2也存在

- 修改元素：
	- 无

- 删除元素：
	- 不支持元素的删除（可从其原理思考

> 不能用于用户注册场景：存储已注册用户名。因为如果用户注销了账号，该用户名就可以再次被使用。然而，布隆过滤器由于无法删除元素，因此无法处理这种情况。（但我觉得或许可以？布隆过滤器判断不存在的一定不存在，但不能保证判断存在的就一定存在，对于存在的就先去查询数据库）
